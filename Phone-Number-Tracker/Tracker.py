from phonenumbers import geocoder, carrier, timezone

import phonenumbers
from phonenumbers import geocoder, carrier, timezone


def validate_phone_number(number):
    try:
        parsed_number = phonenumbers.parse(number)
        if phonenumbers.is_valid_number(parsed_number):
            return parsed_number
        else:
            return None
    except phonenumbers.NumberParseException:
        return None


def get_location(parsed_number):
    return geocoder.description_for_number(parsed_number, "en")


def get_carrier(parsed_number):
    return carrier.name_for_number(parsed_number, "en")


def get_time_zones(parsed_number):
    return timezone.time_zones_for_number(parsed_number)


# Input phone number in this format: "+91278738278"
number = input("Enter phone number: ")

parsed_number = validate_phone_number(number)

if parsed_number is None:
    print(
        "Invalid phone number. Please make sure you enter the phone number in the correct format."
    )
else:
    location = get_location(parsed_number)
    carrier_name = get_carrier(parsed_number)
    time_zones = get_time_zones(parsed_number)

    print("Location:", location)
    print("Carrier:", carrier_name)
    print("Time Zone:", time_zones)


def format_phone_number(ch_num):
    return phonenumbers.format_number(
        ch_num, phonenumbers.PhoneNumberFormat.INTERNATIONAL
    )


def print_phone_number_info(ch_num):
    print("Phone Number: ", format_phone_number(ch_num))
    print("Country: ", geocoder.description_for_number(ch_num, "en"))
    print("Carrier: ", carrier.name_for_number(ch_num, "en"))
    print("Time Zone: ", timezone.time_zones_for_number(ch_num))


def validate_phone_number(numbers):
    if "+" not in numbers:
        print("Please make sure you enter the phone number in the correct format")
        return None

    try:
        ch_num = phonenumbers.parse(numbers)
        if phonenumbers.is_valid_number(ch_num):
            return ch_num
        else:
            possible = phonenumbers.is_possible_number(ch_num)
            print("Number is not valid")
            print("Number is Possible: ", possible)
    except phonenumbers.NumberParseException as e:
        print(str(e))

    return None


def main():
    while True:
        numbers = input("Enter phone number (enter 'q' to quit): ")
        if numbers == "q":
            break

        ch_num = validate_phone_number(numbers)
        if ch_num:
            print_phone_number_info(ch_num)

        print()


if __name__ == "__main__":
    main()
